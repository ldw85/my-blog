---
import type { InferGetStaticPropsType, GetStaticPaths } from 'astro';
import { blogCategoryRobots, getStaticPathsBlogCategory } from '~/utils/blog';

import Layout from '~/layouts/PageLayout.astro';
import BlogList from '~/components/blog/List.astro';
import Headline from '~/components/blog/Headline.astro';
import Pagination from '~/components/blog/Pagination.astro';

export const prerender = true;

export const getStaticPaths = (async ({ paginate }) => {
  return await getStaticPathsBlogCategory({ paginate });
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths> & { category: Record<string, string> };

const { page, category } = Astro.props as Props;

const currentPage = page.currentPage ?? 1;

// Category mapping
const categoryInfo: Record<string, { emoji: string; desc: string }> = {
  'Audio': { emoji: 'ğŸ§', desc: 'Headphones, speakers, and audio equipment reviews' },
  'Smart Home': { emoji: 'ğŸ ', desc: 'Smart home product reviews' },
  'Mobile': { emoji: 'ğŸ“±', desc: 'Phones, tablets, and mobile device reviews' },
  'Computing': { emoji: 'ğŸ’»', desc: 'Computers and computing device reviews' },
  'Peripherals': { emoji: 'âŒ¨ï¸', desc: 'Keyboards, mice, and peripheral reviews' },
  'Apple': { emoji: 'ğŸ', desc: 'Apple ecosystem product reviews' },
  'Photography': { emoji: 'ğŸ“·', desc: 'Camera and imaging equipment reviews' },
  'Gaming': { emoji: 'ğŸ®', desc: 'Gaming equipment reviews' },
  'Wearables': { emoji: 'âŒš', desc: 'Smart wearable device reviews' },
  'AI Tools': { emoji: 'ğŸ¤–', desc: 'In-depth AI tool reviews' },
  'AI News': { emoji: 'ğŸ“°', desc: 'AI industry news' },
  'SaaS': { emoji: 'ğŸ’¼', desc: 'SaaS tool recommendations' },
  'Productivity': { emoji: 'âš¡', desc: 'Productivity tools and methodologies' },
};

const info = categoryInfo[category.title] || { emoji: 'ğŸ“', desc: '' };

const metadata = {
  title: `${info.emoji} ${category.title}`,
  description: info.desc,
  robots: {
    index: blogCategoryRobots?.index,
    follow: blogCategoryRobots?.follow,
  },
};
---

<Layout metadata={metadata}>
  <!-- Category Header -->
  <section class="py-12 not-prose bg-slate-50 dark:bg-slate-900">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 text-center">
      <div class="text-6xl mb-4">{info.emoji}</div>
      <h1 class="text-3xl md:text-4xl font-bold mb-2">{category.title}</h1>
      {info.desc && <p class="text-lg text-muted">{info.desc}</p>}
      
      <div class="mt-6">
        <a href="/blog" class="inline-flex items-center text-blue-600 hover:underline">
          â† Back to All Posts
        </a>
      </div>
    </div>
  </section>

  <!-- Posts List -->
  <section class="px-6 sm:px-6 py-12 sm:py-16 lg:py-20 mx-auto max-w-5xl">
    <Headline subtitle={`${page.data.length} articles`}></Headline>
    <BlogList posts={page.data} />
    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} />
  </section>
</Layout>
