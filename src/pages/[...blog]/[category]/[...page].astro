---
import type { InferGetStaticPropsType, GetStaticPaths } from 'astro';
import { blogCategoryRobots, getStaticPathsBlogCategory } from '~/utils/blog';

import Layout from '~/layouts/PageLayout.astro';
import BlogList from '~/components/blog/List.astro';
import Headline from '~/components/blog/Headline.astro';
import Pagination from '~/components/blog/Pagination.astro';

export const prerender = true;

export const getStaticPaths = (async ({ paginate }) => {
  return await getStaticPathsBlogCategory({ paginate });
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths> & { category: Record<string, string> };

const { page, category } = Astro.props as Props;

const currentPage = page.currentPage ?? 1;

// åˆ†ç±»æ˜ å°„
const categoryInfo: Record<string, { emoji: string; desc: string }> = {
  'Audio': { emoji: 'ğŸ§', desc: 'è€³æœºã€éŸ³ç®±ç­‰éŸ³é¢‘è®¾å¤‡è¯„æµ‹' },
  'Smart Home': { emoji: 'ğŸ ', desc: 'æ™ºèƒ½å®¶å±…äº§å“è¯„æµ‹' },
  'Mobile': { emoji: 'ğŸ“±', desc: 'æ‰‹æœºã€å¹³æ¿ç­‰ç§»åŠ¨è®¾å¤‡è¯„æµ‹' },
  'Computing': { emoji: 'ğŸ’»', desc: 'ç”µè„‘ã€è®¾å¤‡ç­‰è®¡ç®—è®¾å¤‡è¯„æµ‹' },
  'Peripherals': { emoji: 'âŒ¨ï¸', desc: 'é”®ç›˜ã€é¼ æ ‡ç­‰å¤–è®¾è¯„æµ‹' },
  'Apple': { emoji: 'ğŸ', desc: 'è‹¹æœç”Ÿæ€äº§å“è¯„æµ‹' },
  'Photography': { emoji: 'ğŸ“·', desc: 'ç›¸æœºã€å½±åƒè®¾å¤‡è¯„æµ‹' },
  'Gaming': { emoji: 'ğŸ®', desc: 'æ¸¸æˆè®¾å¤‡è¯„æµ‹' },
  'Wearables': { emoji: 'âŒš', desc: 'æ™ºèƒ½ç©¿æˆ´è®¾å¤‡è¯„æµ‹' },
  'AI Tools': { emoji: 'ğŸ¤–', desc: 'AI å·¥å…·æ·±åº¦è¯„æµ‹' },
  'AI News': { emoji: 'ğŸ“°', desc: 'AI è¡Œä¸šèµ„è®¯' },
  'SaaS': { emoji: 'ğŸ’¼', desc: 'SaaS å·¥å…·æ¨è' },
  'Productivity': { emoji: 'âš¡', desc: 'æ•ˆç‡å·¥å…·ä¸æ–¹æ³•è®º' },
};

const info = categoryInfo[category.title] || { emoji: 'ğŸ“', desc: '' };

const metadata = {
  title: `${info.emoji} ${category.title}`,
  description: info.desc,
  robots: {
    index: blogCategoryRobots?.index,
    follow: blogCategoryRobots?.follow,
  },
};
---

<Layout metadata={metadata}>
  <!-- åˆ†ç±»å¤´éƒ¨ -->
  <section class="py-12 not-prose bg-slate-50 dark:bg-slate-900">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 text-center">
      <div class="text-6xl mb-4">{info.emoji}</div>
      <h1 class="text-3xl md:text-4xl font-bold mb-2">{category.title}</h1>
      {info.desc && <p class="text-lg text-muted">{info.desc}</p>}
      
      <div class="mt-6">
        <a href="/blog" class="inline-flex items-center text-blue-600 hover:underline">
          â† è¿”å›å…¨éƒ¨æ–‡ç« 
        </a>
      </div>
    </div>
  </section>

  <!-- æ–‡ç« åˆ—è¡¨ -->
  <section class="px-6 sm:px-6 py-12 sm:py-16 lg:py-20 mx-auto max-w-5xl">
    <Headline subtitle={`${page.data.length} ç¯‡æ–‡ç« `}></Headline>
    <BlogList posts={page.data} />
    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} />
  </section>
</Layout>
